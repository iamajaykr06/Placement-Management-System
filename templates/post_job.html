{% extends "base.html" %}
{% block title %}Post Job - Placement System{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2>Post a New Job</h2>
        <p style="color: var(--text-secondary);">Create a detailed job posting to attract qualified candidates</p>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form method="post" style="margin-bottom: 3rem;">
        <div class="grid grid-2">
            <div>
                <h3 style="color: var(--primary-color); margin-bottom: 1.5rem;">Job Details</h3>
                
                <div class="form-group">
                    <label for="title">Job Title *</label>
                    <input
                        type="text"
                        id="title"
                        name="title"
                        placeholder="e.g., Software Engineer, Data Analyst"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="job_type">Job Type *</label>
                    <select id="job_type" name="job_type" class="form-group" required>
                        <option value="full-time">Full Time</option>
                        <option value="part-time">Part Time</option>
                        <option value="internship">Internship</option>
                        <option value="contract">Contract</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="location">Location</label>
                    <input
                        type="text"
                        id="location"
                        name="location"
                        placeholder="e.g., Bangalore, Remote, Hybrid"
                    >
                </div>

                <div class="form-group">
                    <label for="description">Job Description *</label>
                    <textarea
                        id="description"
                        name="description"
                        placeholder="Provide detailed job description, responsibilities, and what you're looking for..."
                        rows="8"
                        required
                    ></textarea>
                </div>
            </div>

            <div>
                <h3 style="color: var(--primary-color); margin-bottom: 1.5rem;">Requirements & Compensation</h3>
                
                <div class="form-group">
                    <label for="requirements">Requirements</label>
                    <textarea
                        id="requirements"
                        name="requirements"
                        placeholder="Required skills, experience, certifications..."
                        rows="5"
                    ></textarea>
                </div>

                <div class="form-group">
                    <label for="eligibility">Eligibility Criteria *</label>
                    <input
                        type="text"
                        id="eligibility"
                        name="eligibility"
                        placeholder="e.g., CGPA >= 7.5, Computer Science/IT students"
                        required
                    >
                </div>

                <div class="form-group">
                    <label>Salary Range</label>
                    <div style="display: flex; gap: 1rem;">
                        <div style="flex: 1;">
                            <label for="salary_min" style="font-size: 0.875rem;">Min (LPA)</label>
                            <input
                                type="number"
                                id="salary_min"
                                name="salary_min"
                                placeholder="Min"
                                min="0"
                                step="0.5"
                            >
                        </div>
                        <div style="flex: 1;">
                            <label for="salary_max" style="font-size: 0.875rem;">Max (LPA)</label>
                            <input
                                type="number"
                                id="salary_max"
                                name="salary_max"
                                placeholder="Max"
                                min="0"
                                step="0.5"
                            >
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="application_deadline">Application Deadline</label>
                    <input
                        type="date"
                        id="application_deadline"
                        name="application_deadline"
                    >
                    <small style="color: var(--text-secondary);">Leave empty for no deadline</small>
                </div>

                <div class="form-group">
                    <label for="max_applications">Maximum Applications</label>
                    <input
                        type="number"
                        id="max_applications"
                        name="max_applications"
                        placeholder="Leave empty for unlimited"
                        min="1"
                        value="100"
                    >
                    <small style="color: var(--text-secondary);">Limit the number of applications (optional)</small>
                </div>
            </div>
        </div>

        <div style="margin-top: 2rem;">
            <button type="submit" class="btn btn-primary">Post Job</button>
            <a href="{{ url_for('company_routes.company_dashboard') }}" class="btn btn-outline">Cancel</a>
        </div>
    </form>

    <hr style="margin: 2rem 0; border: none; border-top: 2px solid var(--border-color);">

    <div class="card-header">
        <h2>Your Posted Jobs</h2>
        <p style="color: var(--text-secondary);">Manage your existing job postings</p>
    </div>

    {% if jobs %}
        {% for job in jobs %}
        <div class="job-card">
            <div class="flex-between">
                <div style="flex: 1;">
                    <h3>{{ job.title }}</h3>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 0.5rem;">
                        {% if job.job_type %}
                        <span class="badge badge-info">{{ job.job_type|title }}</span>
                        {% endif %}
                        {% if job.location %}
                        <span class="badge badge-info">üìç {{ job.location }}</span>
                        {% endif %}
                        {% if job.salary_min and job.salary_max %}
                        <span class="badge badge-success">üí∞ {{ job.salary_min }}-{{ job.salary_max }} LPA</span>
                        {% endif %}
                        {% if job.status %}
                        <span class="badge badge-{{ 'success' if job.status == 'active' else 'warning' }}">
                            {{ job.status|title }}
                        </span>
                        {% endif %}
                    </div>
                    {% if job.eligibility %}
                    <div class="eligibility" style="margin-top: 1rem;">
                        <strong>Eligibility:</strong> {{ job.eligibility }}
                    </div>
                    {% endif %}
                    {% if job.current_applications %}
                    <div style="margin-top: 0.5rem; color: var(--text-secondary);">
                        <strong>{{ job.current_applications }}</strong> application{{ 's' if job.current_applications != 1 else '' }}
                    </div>
                    {% endif %}
                </div>
                <div>
                    <a href="{{ url_for('company_routes.view_applicants', job_id=job.id) }}" class="btn btn-secondary btn-sm">
                        View Applicants ({{ job.current_applications|default(0) }})
                    </a>
                </div>
            </div>
            {% if job.description %}
            <div class="description" style="margin-top: 1rem;">
                {{ job.description[:200] }}{% if job.description|length > 200 %}...{% endif %}
            </div>
            {% endif %}
        </div>
        {% endfor %}
    {% else %}
        <div class="empty-state">
            <p style="font-size: 1.25rem; margin-bottom: 0.5rem;">No jobs posted yet</p>
            <p style="color: var(--text-secondary);">Post your first job above to get started</p>
        </div>
    {% endif %}
</div>
{% endblock %}
